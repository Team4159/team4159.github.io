<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="How we organize our robot code">
<meta name="keywords" content=" command based, programming, wpilib">
<title>Command Based Programming | CardinalBotics Programming Portal</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">-->
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="team4159.github.io" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand" href="index.html" style="padding-left:0px">&nbsp;
                <span class="projectTitle">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 345.878 345.878" style="enable-background:new 0 0 345.878 345.878;" xml:space="preserve" width="16px" height="16px">
                        <path d="M286.841,321.622c0.424-0.48,0.567-1.08,0.405-1.688c-0.883-3.313-12.812-7.684-37.926-16.19  c-16.169-5.477-32.887-11.139-38.713-15.033c-2.266-1.514-9.62-10.472-15.528-17.669c-4.73-5.762-7.965-9.679-9.669-11.376  c0.547-0.13,1.259-0.274,1.958-0.416c5.543-1.123,18.525-3.752,35.926-14.268c21.542-13.02,42.952-33.75,63.635-61.616  c43.162-58.151,38.604-88.664,36.657-101.693c-0.421-2.818-0.726-4.854-0.374-5.961c1.235-3.894,1.423-5.914,0.648-6.972  c-0.348-0.475-0.884-0.736-1.509-0.736c-0.989,0-2.089,0.627-3.253,1.292c-0.521,0.297-1.255,0.716-1.703,0.871  c0.003-0.507,0.205-1.818,1.44-5.052c3.045-7.978,2.791-9.385,2.27-10.142c-0.26-0.377-0.673-0.593-1.133-0.593  c-1.241,0-2.843,1.661-5.917,5.561c5.26-13.727,7.878-21.567,6.684-23.656c-0.267-0.467-0.706-0.735-1.204-0.735  c-1.52,0-3.032,2.396-7.342,11.903c0.074-0.328,0.148-0.659,0.224-0.992c5.143-22.829,5.517-26.983,4.028-27.876  c-0.202-0.122-0.433-0.186-0.666-0.186c-1.619,0-2.812,2.66-6.712,14.978c-0.116,0.37-0.236,0.749-0.358,1.132  c0.07-0.434,0.142-0.871,0.213-1.306c1.357-8.312,3.409-20.873,3.169-29.05C312.022,1.798,311.859,0,310.474,0  c-1.533,0-2.21,1.603-6.532,20.006c-1.454,6.191-2.957,12.593-4.274,17.134c-3.724,12.832-13.196,36.067-20.3,47.955  c-14.9,24.935-18.822,29.799-71.322,73.48c-24.925,20.737-56.261,42.942-60.334,44.761c-2.093-2.251-11.898-19.777-16.722-36.056  c-4.182-14.113-14.883-30.277-21.275-39.935c-2.14-3.232-3.83-5.785-4.318-6.859c-1.308-2.878-4.151-4.621-6.661-6.158  c-1.506-0.923-2.929-1.794-3.634-2.708c-1.326-1.72-2.224-4.709-3.175-7.875c-1.522-5.068-3.247-10.813-7.406-13.684  c-1.227-0.847-2.284-1.258-3.234-1.258c-1.371,0-2.221,0.822-2.903,1.482c-0.637,0.615-1.026,0.964-1.631,0.964  c-0.375,0-0.838-0.136-1.373-0.404c-2.321-1.161-5.025-9.227-6.999-15.117c-2.383-7.11-3.417-9.85-4.836-10.408  c-0.249-0.098-0.505-0.147-0.76-0.147c-1.967,0-3.004,2.709-4.007,5.33c-0.267,0.696-0.632,1.649-0.927,2.224  c-0.813-1.292-2.233-4.725-3.313-7.334c-3.062-7.399-4.467-10.443-6.054-10.747l-0.242-0.023c-0.759,0-2.469-0.001-5.196,15.109  c-0.494-1.353-1.085-3.031-1.666-4.683c-5.559-15.787-7.246-19.417-9.027-19.417l-0.197,0.015  c-1.904,0.296-2.402,3.675-3.238,15.998c-0.258,3.803-0.592,8.727-1.052,11.032c-0.021-0.057-0.041-0.116-0.063-0.179  c-1.234-3.563-2.203-4.952-3.458-4.952c-1.281,0-3.216,0-3.216,19.859c0,15.128,7.035,56.931,15.053,76.047  c7.168,17.094,8.654,18.573,11.617,21.52l0.361,0.36c0.681,0.681,1.259,1.108,1.699,1.391c-0.516,0.516-1.289,1.32-2.358,2.635  c-3.167,3.898-4.302,5.501-3.645,6.88c0.515,1.083,1.888,1.232,3.296,1.232c0.913,0,2.072-0.07,4-0.241l0.19-0.017  c4.858-0.435,7.915-0.597,15.337,8.267c6.164,7.362,8.539,23.675,10.446,36.783c0.39,2.678,0.766,5.258,1.154,7.658  c2.401,14.809,4.444,20.9,28.264,39.955c18.113,14.49,47.079,20.204,66.246,23.984c3.752,0.74,6.999,1.38,9.675,1.994  c7.145,3.25,15.569,7.913,24.488,12.848c2.464,1.364,4.948,2.739,7.429,4.096c16.832,9.21,33.141,12.553,39.996,12.553  c1.348,0,2.267-0.132,2.809-0.403c0.085-0.042,0.354-0.142,1.012-0.142c1.115,0,2.67,0.275,4.174,0.541  c1.552,0.274,3.018,0.533,4.15,0.533c2.317,0,2.567-1.277,2.567-1.827c0-0.063,0.007-0.099,0.004-0.105  c0.223-0.175,1.254-0.233,2.01-0.276c1.758-0.099,4.164-0.235,6.798-1.451c2.639-1.218,2.892-2.396,2.948-3.809  c0.041-1.051,0.089-2.242,3.8-4.459c1.597-0.954,2.458-1.889,2.709-2.944c0.309-1.298-0.368-2.367-1.023-3.4  C285.262,325.918,284.337,324.459,286.841,321.622z" fill="#FFFFFF"/>
                    </svg>
                    CardinalBotics Programming Portal
            </span>

            </a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="projects">Projects</a></li>
                
                
                
                <li><a href="blog">Blog</a></li>
                
                
                
                <li><a href="https://github.com/team4159/team4159.github.io" target="_blank">Git</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:pr@team4159.org?subject=CardinalBotics Programming Portal feedback&body=I have some feedback about the Command Based Programming page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Email</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="Command Based Programming">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Content </li>
  
  
  
      
  
  <li>
      <a href="#">General Programming</a>
      <ul>
          
          
          
          <li><a href="main_general_programming_intro.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a href="main_java.html">Java</a></li>
          
          
          
          
          
          
          <li><a href="main_oop.html">OOP</a></li>
          
          
          
          
          
          
          <li><a href="main_cl.html">Command Line</a></li>
          
          
          
          
          
          
          <li><a href="main_git.html">Git/Version Control</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Robot Programming</a>
      <ul>
          
          
          
          <li><a href="main_robot_programming_intro.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a href="main_wpilib.html">WPILib and Gradle</a></li>
          
          
          
          
          
          
          <li class="active"><a href="main_command_based_programming.html">Command Based Programming</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Electronics</a>
      <ul>
          
          
          
          <li><a href="main_electronics_intro.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a href="main_basic_theory.html">Basic Theory</a></li>
          
          
          
          
          
          
          <li><a href="main_frc_electronics.html">FRC Electronics</a></li>
          
          
          
          
          
          
          <li><a href="main_sensors.html">Sensors</a></li>
          
          
          
          
          
          
          <li><a href="main_actuators.html">Actuators</a></li>
          
          
          
          
          
          
          <li><a href="main_wiring.html">Wiring</a></li>
          
          
          
          
          
          
          <li><a href="main_pneumatics.html">Pneumatics</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Control Systems</a>
      <ul>
          
          
          
          <li><a href="main_control_intro.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a href="main_pid.html">PID Control</a></li>
          
          
          
          
          
          
          <li><a href="main_vision.html">Computer Vision</a></li>
          
          
          
          
          
          
          <li><a href="main_mp.html">Motion Profiling</a></li>
          
          
          
          
          
          
          <li><a href="main_ml.html">Machine Learning</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Web Development</a>
      <ul>
          
          
          
          <li><a href="main_web_intro.html">Introduction</a></li>
          
          
          
          
          
          
          <li><a href="main_reactjs.html">React.js and Other Libraries</a></li>
          
          
          
          
          
          
          <li><a href="main_hybrid_apps.html">Hybrid App Development</a></li>
          
          
          
          
          
          
          <li><a href="main_squarespace.html">Squarespace</a></li>
          
          
          
          
          
          
          <li><a href="main_jekyll.html">Jekyll</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Tag archives</a>
      <ul>
          
          
          
          <li><a href="main_tag_archives_overview.html">Tag archives overview</a></li>
          
          
          
          <li class="subfolders">
              <a href="#">Tag archive pages</a>
              <ul>
                  
                  
                  
                  <li><a href="tag_formatting.html">Formatting pages</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tag_navigation.html">Navigation pages</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tag_content_types.html">Content types pages</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tag_publishing.html">Publishing pages</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tag_special_layouts.html">Special layout pages</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tag_collaboration.html">Collaboration pages</a></li>
                  
                  
                  
                  
                  
                  <li><a href="tag_troubleshooting.html">Troubleshooting pages</a></li>
                  
                  
                  
              </ul>
          </li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">Command Based Programming</h1>
</div>



<div class="post-content">

   
    <div class="summary">How we organize our robot code</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    

  <h2 id="overview">Overview</h2>

<p>We follow the Command-based robot model to organize our robot code. This method of organization separates the robot code into subsystems and commands, and it allows us to utilize built-in support from WPILib.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/overview_robot_files.png" alt="Github Source Files Screenshot" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Organization of our 2018 robot code</em></td>
    </tr>
  </tbody>
</table>

<p>Under this method, the robot code is divided into what the robot has and does (<a href="#subsystems">subsystems</a>) and instruction for the robot (<a href="#commands">commands</a>). We write functions for receiving joystick input and put these in the <a href="#operator-interface-oi">Operator Interface (OI)</a> class. Fixed numbers (<a href="#constant-maps">constants</a>) are separated into their own files, making them quick to find and easy to change. Meanwhile, the <a href="#main-robot-class">main robot class</a> stays nice and clean, handling initializations or periodic functions that don’t fit in elsewhere.</p>

<p>In particular, the rest of this article explains how and why we organize our code this way, which may be different from other teams. To get a better idea of how Command-based Programming works, take a look at WPILib’s explanation: <a href="http://wpilib.screenstepslive.com/s/currentCS/m/java/l/599732-what-is-command-based-programming">What is Command based programming?</a></p>

<h2 id="subsystems">Subsystems</h2>

<h3 id="whats-a-subsystem">What’s a Subsystem?</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/subsystems_robot_files.png" alt="Github Subsystems Files Screenshot" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Our different subsystems (2018)</em></td>
    </tr>
  </tbody>
</table>

<p>The robot is split into separate subsystems, and although this is usually defined by the people who design the robot, our general rule is that one unit should be a group of sensors and output devices (e.g. actuators or LEDs) that depend each other to perform actions, but each sensor and output can only belong to one subsystem.</p>

<p>For example, notice that our 2018 robot has a <code class="highlighter-rouge">CubeHolder</code> subsystem. This subsystem both picks up and shoots cubes, however, it cannot do both at once, since the motors that intake the cube are the same motors that shoot the cube. Thus, we awkwardly call it the <code class="highlighter-rouge">CubeHolder</code>, as opposed to making both a <code class="highlighter-rouge">CubeShooter</code> and <code class="highlighter-rouge">CubeIntake</code> class.
 By the way, you will break the code if you try to assign a single channel/ID to two motor controller objects.</p>

<h3 id="what-goes-in-a-subsystem-class">What Goes in a Subsystem Class?</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/subsystems_template.PNG" alt="WPILib Template" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Start with the FRC plugin provided template</em></td>
    </tr>
  </tbody>
</table>

<p>As mentioned in the overview, a subsystem class is comprised of what the subsystem has and what it does (not necessarily when it does something, though; we’ll go over that later). What this means is variables for any sensors or output devices that belongs to a subsystem should be assigned here, as well as other variables or constants that only belong to that one subsystem. Additionally, you’ll want to put initializations and calls to configuration/setup functions in the class constructor.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/subsystems_variables_examples.PNG" alt="Variables" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Examples of variables and other setup in subsystems (2018)</em></td>
    </tr>
  </tbody>
</table>

<p>Right below the constructor, we can start writing out subsystem functions: the programming for everything the subsystems will do. This is where functions that set actuator speeds, positions, or modes go, and it is essentially where you do most of the actual programming.</p>

<p>Make sure to check out the documentation for the <a href="http://first.wpi.edu/FRC/roborio/release/docs/java/">WPILib API</a> and the <a href="http://www.ctr-electronics.com/downloads/api/java/html/index.html">CTRE API</a> for what functions to use for what motor controllers, sensors, etc. For more detail on how to program these, see the <a href="https://team4159.github.io/main_electronics_intro.html">electronics section</a> of our site.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/subsystems_functions_examples.PNG" alt="Functions" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Examples of functions in subsystems (2018)</em></td>
    </tr>
  </tbody>
</table>

<p>Something to be careful of is that <strong>this is not where code for joystick input goes.</strong> The functions should not be programmed to depend on input from sources outside the class, but it’s OK if the input (e.g. sensor input) is coming from within the class.</p>

<p>When programming a lifter, for instance, it’s alright to write a function that uses the reading of an encoder that has been initialized in the lifter’s subsystem. On the other hand, you do not want include a function with something like, “if the joystick button is pressed, then stop.” The joystick input does not come from within the class and should not be programmed to do so. Instead, get rid of that “if” and just write out the stopping part.</p>

<p>So how do you get subsystem to actually do something? You’ve written out all the things that the subsystem <em>can</em> do, but the functions won’t run unless you tell them to—and that’s where commands come in.</p>

<h2 id="commands">Commands</h2>
<p>If you want your elevator subsystem to start lifting once the driver presses a button, or you want some LEDs to flash wildly 15 seconds before the end of a match, you’ll want to program this in an FRC command class.</p>

<p>Commands are where you tie in subsystem functions with external input such as match time, controller input, or another subsystem. In a sense, commands are made up of statements to “activate” subsystem functions.</p>

<p>We’ll go over a few things here, but starting out with the FRC Command template should give a pretty good idea of what needs to go in a command. Read the <a href="http://wpilib.screenstepslive.com/s/currentCS/m/java/l/599737-creating-simple-commands">Creating Simple Commands</a> article for more details and examples.</p>

<h3 id="teleoperated-period-commands">Teleoperated Period Commands</h3>
<p>The teleoperated period (A.K.A. teleop) is when human drivers take control over the robot. Of the two programmable robot modes, this is usually the easier, more straight-forward mode to program.</p>

<p>Before anything else, be sure list out what subsystems the command will use in the command’s constructor using the <code class="highlighter-rouge">requires()</code> function.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/commands_template.png" alt="Commands Template" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="/images/main/command_based_programming/commands_requires_example.png" alt="Command Dependencies" /></td>
    </tr>
    <tr>
      <td style="text-align: center"><em>Use the <code class="highlighter-rouge">requires()</code> function to declare subsystem dependencies. In the case that a certain command needs functions from more than one subsystem, use <code class="highlighter-rouge">requires()</code> again for each additional subsystem.</em></td>
    </tr>
  </tbody>
</table>

<p>Next up, you actually write what the command does: the <code class="highlighter-rouge">execute()</code> function runs over and over again as long as the command hasn’t ended or been interrupted. Here, you can put calls to a subsystem’s functions or add conditionals as you see fit, making sure to define an ending condition in <code class="highlighter-rouge">isFinished()</code>.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/commands_execute_example.png" alt="Command Execute" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>An example of a command from our 2018 robot. It calls <code class="highlighter-rouge">intake()</code> from the <code class="highlighter-rouge">cubeHolder</code> class.</em></td>
    </tr>
  </tbody>
</table>

<p>But what if you don’t want a command to end? You might have noticed that it says to “set the default command” under <code class="highlighter-rouge">initDefaultCommand()</code> at the bottom of a subsystem class . A <a href="https://wpilib.screenstepslive.com/s/currentCS/m/java/l/599742-default-commands">default command</a> is what the subsystem uses when there is no other command to run. Because of that, we generally use this for movements that continually need input, for example, the controlling the drivetrain or moving a manually controlled elevator.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/commands_default_command.PNG" alt="Default Command" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em><code class="highlighter-rouge">initDefaultCommand()</code> function for setting the default command. Unlike the example to the right (2018 robot), you should probably include “default” in the command name to avoid confusion.</em></td>
    </tr>
  </tbody>
</table>

<p>But say you want a quick-lift command for your robot, so that the lifter goes to a certain height at a single button press. For these situations, you’d make a new command for each specific action. Then, these commands would be activated with controller input through the OI class constructor, which we discuss further down the page (<a href="#operator-interface-oi">↓</a>). The advantage of this is that these commands can be also be used for the autonomous period, which may help to keep code clean, as illustrated in <a href="http://wpilib.screenstepslive.com/s/currentCS/m/java/l/599740-running-commands-during-the-autonomous-period">this article</a>.</p>

<p>In past years, though not as versatile, we chose to use default commands as a subsystem’s sole command during teleop. In this case, there would be only one command during teleop, and any other command would be just for the autonomous period. Arguably, this isn’t the best practice for utilizing commands; it’s just what we happened to learn first, and we haven’t run into any issues with this method.</p>

<p>Something that’s important to note is that we never <em>directly</em> call <code class="highlighter-rouge">button</code> and <code class="highlighter-rouge">joystick</code> class methods here in the default command class. Instead, we code all of that in the separate OI class. To keep things simple for now, everything followed by <code class="highlighter-rouge">oi.</code> is just the state of a certain button, yielding <code class="highlighter-rouge">true</code> if it’s pressed.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/commands_teleop_execute.png" alt="Teleop Command" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Example of a teleop command for our 2018 <code class="highlighter-rouge">CubeHolder</code> subsystem.</em></td>
    </tr>
  </tbody>
</table>

<h3 id="autonomous-period-commands">Autonomous Period Commands</h3>
<p>The autonomous period (A.K.A. auto) makes up the first 15 seconds of each match, during which the robot has to move without human input. A large part of what makes programming for auto tricky is that moving autonomously requires an increased use of sensors, calibration, and fancy algorithms.</p>

<p>Of course, there’s a lot of potential to autonomous programming. In fact, autonomous features are often integrated into subsystems and used during the teleop as well. However, if you’re interested in these algorithms and theories, we’d recommend you look in the control systems section of our site, as this section here only covers how we initialize simple commands for auto.</p>

<p>Programing autonomous commands is very much the same as it is for teleop commands; after all, as long as the command does not rely on controller input, the command is interchangeable between teleop and auto. Scroll down to the bottom of the <a href="http://wpilib.screenstepslive.com/s/currentCS/m/java/l/599740-running-commands-during-the-autonomous-period">Running Commands During the Autonomous Period</a> article, and you’ll see that the difference lies in how to start the command.</p>

<p>Note that you must create a new Command <em>object</em>, then initialize it with an already-complete command that you want to run (look below for an example). It will start running when the Command class method, <code class="highlighter-rouge">.start()</code>, is called.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/commands__auto_new_command.png" alt="Auto Command Start" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Example from our 2018 robot. We chose to initialize <code class="highlighter-rouge">autoCommand</code> in <code class="highlighter-rouge">autonomousInit()</code>. <code class="highlighter-rouge">autoCommand</code> is the new Command object, and <code class="highlighter-rouge">Auto</code> is the command that we want to run.</em></td>
    </tr>
  </tbody>
</table>

<h3 id="command-groups">Command Groups</h3>
<p>Often times, you’ll want a series of commands to go off at once, especially in autonomous. You could try coding all the functions you need into one command, but a more flexible and convenient way to go about this is to use a command group.</p>

<p>A command group allows you to order and sequence commands using the functions <code class="highlighter-rouge">addSequential()</code> and <code class="highlighter-rouge">addParallel()</code>. You can find more a more in-depth explanation <a href="http://wpilib.screenstepslive.com/s/currentCS/m/java/l/599738-creating-groups-of-commands">here</a>.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/commands_command_group.png" alt="Command Group" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Example of a command group for auto (2018). Use functions <code class="highlighter-rouge">addParallel()</code> and <code class="highlighter-rouge">addSequential()</code> in the constructor of the command group.</em></td>
    </tr>
  </tbody>
</table>

<p>Because it is a subclass of the command class, you can still treat it as a command. This means if you want to run a command group, you would do the same thing as you would for a normal command: initialize it as a Command, then use the Command method <code class="highlighter-rouge">.start()</code> to run the command group.</p>

<h2 id="operator-interface-oi">Operator Interface (OI)</h2>
<p>By now you’re probably sick of hearing, “But this isn’t where you put joystick input,” and maybe you’re also wondering why “OI” is sprinkled all over the code.</p>

<p>What the Operator Interface class does is it handles joystick and button input. This is where you can decide which buttons go to which commands and how a button should activate a command. All joystick and other controller objects should be made here, along with functions to return joystick or button values.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/oi_constructor.png" alt="OI Objects" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Example of <code class="highlighter-rouge">Joystick</code>/<code class="highlighter-rouge">Button</code> objects used in the OI class to run commands. See the <a href="https://wpilib.screenstepslive.com/s/currentCS/m/java/l/599739-running-commands-on-joystick-input">WPILib</a> article for more detail.</em></td>
    </tr>
  </tbody>
</table>

<p>The standard method of linking commands to controller input is to activate the command through some button object, as shown above.  However, for commands that need the value of a joystick axis (and all default commands, for that matter), you must make use of accessor methods.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/oi_functions.png" alt="OI Functions" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Examples of accessor methods in the OI class. The Math class methods, <code class="highlighter-rouge">.pow</code> and <code class="highlighter-rouge">.copySign</code>,  are used to square the axis value, essentially making the joystick less sensitive and easier to control. For buttons in default commands, use <code class="highlighter-rouge">Joystick</code> class methods for button states.</em></td>
    </tr>
  </tbody>
</table>

<p>In the example above, we use <code class="highlighter-rouge">.getRawButtonPressed()</code>, but there is also <code class="highlighter-rouge">.getRawButton()</code>, <code class="highlighter-rouge">.getRawButtonReleased()</code>, and another set of methods for the joystick trigger. Check out the <a href="http://first.wpi.edu/FRC/roborio/release/docs/java/">documentation</a> for more detail on how these methods are used.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/oi_default_command.png" alt="OI in Default Commands" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Example of how we use OI class methods in default commands.</em></td>
    </tr>
  </tbody>
</table>

<h2 id="constant-maps">Constant Maps</h2>
<p>Under the pressure of competition season, you reeeaally don’t have time to be digging around the code after you forget which wire goes where or which button does what.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/constants_oi_examples.png" alt="Constants Use" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>See those grey-boxed terms? In <a href="https://www.jetbrains.com/idea/">IntelliJ</a>, parameter hints are turned on by default (and that’s one reason why we recommend using IntelliJ as your IDE), but your partner skimming over the code on GitHub won’t see that, and they might have no idea what “3” means.</em></td>
    </tr>
  </tbody>
</table>

<p>That’s why, in good coding style, we assign these port numbers, buttons, and IDs to variables, which we keep in separate files. In addition to looking neat, this makes wiring and buttons simple to look up and change.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/constants_files_examples.png" alt="Constant Maps" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>A few examples of the what what we use constant maps for. Technically they’re not constants, but ehhh it’s close enough.</em></td>
    </tr>
  </tbody>
</table>

<p><strong>RobotMap</strong> is where we keep Roborio PWM port numbers, CAN IDs, PCM channels, and other wiring assignments for sensors and whatnot—it’s super useful when rewiring needs to happen.</p>

<p><strong>ControlMap</strong> is where we keep joystick ports and button assignments, because yes, you and the drivers will end up forgetting the controls.</p>

<p><strong>Constants</strong> is where we throw any numbers we don’t have a place for. Ideally, we try to keep other constants, like tuning constants, within their respective classes, but if they’re universal, in the sense that they don’t change across subsystems, we like keep them here.</p>

<h2 id="main-robot-class">Main Robot Class</h2>
<p>So we’ve gone through pretty much every basic type of file you’ll have in your robot code folder, except for the main robot class. So what does it do anyway? If you’re following the Command-based robot model properly, the answer should be not much.</p>

<p>There are functions that are set up to run on initialization or periodically, depending on the game mode. Here are a few examples:</p>

<ul>
  <li><code class="highlighter-rouge">robotInit()</code>: called right when the robot starts up.</li>
  <li><code class="highlighter-rouge">teleopPeriodic()</code>: runs over and over again when the robot is in teleop mode.</li>
  <li><code class="highlighter-rouge">disabledPeriodic()</code>: runs when the robot is on, but disabled.</li>
  <li><code class="highlighter-rouge">testPeriodic()</code>: runs when the robot is in test mode.</li>
  <li><code class="highlighter-rouge">autonomousInit()</code>: runs at the start of auto. We recommend initializing auto commands in <code class="highlighter-rouge">autonomousInit()</code>, as opposed to <code class="highlighter-rouge">robotInit()</code>, so the robot has a chance to receive game data first.</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/robot_autonomousInit.png" alt="autonomousInit Function" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>An example of what we do at the start of the autonomous period. <code class="highlighter-rouge">Auto</code> is a command that contains other command groups to choose from.</em></td>
    </tr>
  </tbody>
</table>

<p>Really, you can do anything with these functions, like zero sensors or print statements, but just know there’s usually a better place. Keeping code out of the main robot function makes for easier navigation and bug-fixing.</p>

<p>Of course there is code that <em>does</em> need to go in the main robot class. As mentioned earlier, this is where you put code to start auto commands. Other than that, there’s going to be at least one instance of a subsystem and an instance of the OI class.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/robot_objects.png" alt="Main Robot Class Objects" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Objects declared and initialized in the main robot class.</em></td>
    </tr>
  </tbody>
</table>

<p>You could declare and initialize all subsystems in the main robot class, but we prefer to wrap our subsystems within another subsystem class named <code class="highlighter-rouge">Superstructure</code>, which also deals with code for the air compressor.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><img src="/images/main/command_based_programming/robot_objects.png" alt="Superstructure" /></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Within this <code class="highlighter-rouge">Superstructure</code> subsystem class, we call the other subsystems’ <code class="highlighter-rouge">.getInstance()</code> method.</em></td>
    </tr>
  </tbody>
</table>

<p>Anyway, that’s all we have here for the organization of our robot code. Again, we don’t cover all the specifics here, so check out <a href="http://wpilib.screenstepslive.com/s/currentCS/m/java">WPILib’s programming sections</a> and <a href="http://first.wpi.edu/FRC/roborio/release/docs/java/">documentation</a> for more details and explanations. Also, feel free to take a look at our robot code in its entirety on our <a href="https://github.com/Team4159">GitHub</a>.</p>

<p><code class="highlighter-rouge">Message from Helen:</code>
If you’ve read through this entire thing, all 2400+ words, I applaud you. Wow. Good job for making it all the way down here, and thanks for putting up with my terrible writing. Be sure to send me a cookie and some feedback, be it pointing out mistakes in my knowledge or nit-picking at my grammer, so future readers (if there are any ; u ; ) don’t have to suffer as much as you did. Thanks again and happy programming!</p>



    <div class="tags">
        
    </div>

    
    <a target="_blank" href="https://github.com/team4159/team4159.github.io/blob/master/pages/main/main_command_based_programming.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>
    

    




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2019 FRC Team 4159 CardinalBotics. All rights reserved. <br />
 Site last generated: Feb 5, 2019 <br />
<p><img src="images/company_logo.png" alt="Company logo"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
